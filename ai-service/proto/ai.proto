syntax = "proto3";

package ai;

option go_package = "diaxel_zerde/ai-service/proto;proto";

service AIService {
  rpc GenerateText(GenerateTextRequest) returns (GenerateTextResponse);
  rpc GenerateResponse(GenerateResponseRequest) returns (GenerateResponseResponse);
  rpc StreamResponse(StreamResponseRequest) returns (stream StreamResponseChunk);
  rpc GetModelInfo(GetModelInfoRequest) returns (ModelInfoResponse);
  rpc ValidatePrompt(ValidatePromptRequest) returns (ValidatePromptResponse);
}

message GenerateTextRequest {
  string prompt = 1;
  string model = 2;
  map<string, string> parameters = 3;
  string assistant_id = 4;
  string user_id = 5;
}

message GenerateTextResponse {
  string text = 1;
  string model_used = 2;
  int64 tokens_used = 3;
  double confidence_score = 4;
  string generated_at = 5;
}

message GenerateResponseRequest {
  string message = 1;
  string chat_id = 2;
  string assistant_id = 3;
  string platform = 4;
  repeated MessageHistory history = 5;
  map<string, string> context = 6;
}

message MessageHistory {
  string role = 1;
  string content = 2;
  string timestamp = 3;
}

message GenerateResponseResponse {
  string response = 1;
  string model_used = 2;
  int64 tokens_used = 3;
  double confidence_score = 4;
  bool is_complete = 5;
  string generated_at = 6;
}

message StreamResponseRequest {
  string message = 1;
  string chat_id = 2;
  string assistant_id = 3;
  string platform = 4;
  repeated MessageHistory history = 5;
  map<string, string> context = 6;
}

message StreamResponseChunk {
  string chunk = 1;
  bool is_complete = 2;
  string model_used = 3;
  int64 tokens_so_far = 4;
}

message GetModelInfoRequest {
  string model_name = 1;
}

message ModelInfoResponse {
  string name = 1;
  string version = 2;
  string description = 3;
  int64 max_tokens = 4;
  repeated string capabilities = 5;
  bool is_available = 6;
}

message ValidatePromptRequest {
  string prompt = 1;
  string model = 2;
}

message ValidatePromptResponse {
  bool is_valid = 1;
  string error_message = 2;
  repeated string warnings = 3;
  int64 estimated_tokens = 4;
}
